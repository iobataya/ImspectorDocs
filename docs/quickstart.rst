.. _Quickstart:

=================
クイックスタート
=================

Imspectorはデータ解析のためのプラグインやハードウェア用のドライバーを備えている。

- VidCap (ほとんどのWebカメラに対応) 
- SimCam (テスト用仮想カメラ) 
- SyncDriver (ダミー軸、シリアルポートによる同期を提供)
- ComDriver (COM/GPIBの汎用ドライバ)
- Timer (タイムラプス等のためのタイマー)
- Becker&Hickl SPCM cards
- National instruments DAQ cards (NiDAQmxドライバを介してスキャナやシャッター、検出器を制御)
- Scanners from PI (PI社のスキャナドライバ)
- Various CCD cameras (種々のCCDカメラ)
 
.. warning::
   ドライバーはdllファイルとしてハードウェアと共にインストールされる。Imspectorのバージョンやハードウェアのドライバーの
   バージョンは対応する組み合わせである必要がある。常に新しいバージョンのImspectorを使用する必要がある。
   ハードウェアドライバーも最新のものにアップデートする必要がある。

インストール
----------

単純にImpsectorをデータ解析につかうだけであれば、インストーラのzipアーカイブを入手して解凍して起動する。インストーラは設定フォルダの場所を聞いてくる。もしImspectorを初めて使うのであればフォルダを作成して選択する。もしすでに設定フォルダがあれば、それを指定する。

.. note::
   OSの設定によってはいくつかのライブラリをインストールする必要があるかもしれない。
   エラーが発生する場合にはAbberiorInstrumentsに問い合わせる。

設定フォルダはImspectorが動作するPCそれぞれ、さらにユーザーそれぞれに独立して選択することもできる。
フォルダ自体はPC特異的な設定だけでなく、ユーザーが作ったカスタムカラーマップ、フィッティングに使う関数、数式も格納する。
そのため、共有PCで使う場合には、ユーザーごとに設定フォルダを作成すると良い。
設定フォルダを変更するには、:menuselection:`&Edit --> &Preferences --> &Configuration Directory`を使う。

このメニューは他にも便利なオプションがある。（起動時のエラーメッセージ回避や、明示的なログの停止など）

.. warning:: 
   設定フォルダーは、定期的にバックアップしておくと良い。
   失ってしまうとせっかく作ったカスタムカラーマップをまた最初から作り直すことになる。
   また、設定フォルダーには装置の光学素子やデバイスのパラメーターが保存されている。
   装置の構成や光学系の調整をする前にバックアップしておけば、問題が起きた場合にも前の状態に戻せて便利である。

デバイスの追加
------------

メニューの :menuselection:`&Hardware --> &Add/Remove Devices` で
リストボックスの追加ボタンをクリックするとデバイスを追加できる。
リストをもつダイアログが現れるので、デバイスのタイプ、名前を指定する。
デバイスは複数追加できる。

.. note:: 
   Imspectorは、そのSDKに対してコンパイルされた独自のドライバーで拡張できる。
   これにはC++ や MFC の知識が必要で、VisualStudio2008を所有している必要がある。

ハードウェア設定の調整
------------------

ハードウェア設定は、 :menuselection:`&Hardware --> &Configure` で可能である。
通常はデバイスのIDを入力する必要があるが、調整しておけばinitializeリンクを押すだけで
デバイスが見つかったかどうかを確認し、設定フォルダに保存された設定が適用される。

.. note:: 
   NIのカードのデバイスIDは、"Dev1"といった文字列で、measurement & automation explorerで見つけることができる。
   NIDAQカードでは、最初にハードウェア設定を初期化・保存した後、Imspectorの再起動が必要になる。
   これは装置のモデルによって使用可能なチャンネルの下図などが変わるからである。
   数値の単位、たとえば µm から V　へのマッピングは、再起動後、このNIcardのハードウェア設定内でできる。
   (チャンネル選択、電圧の最小値・最大値の設定、対応するスキャナのエリアなど）

測定の設定
--------

Measurementドキュメントを開き、:menuselection:`&Measurement --> Edit Settings`を選択する。
このウィンドウによって測定条件のパラメータを設定できる。多くの複数のmeasurements(データ)を同時に開ける。
データ(measurement)にはそれぞれの測定条件が紐付けられており、測定条件を即座に切り替えることができる。

ほとんどのプロパティウィンドウは、ハードウェア設定で設定した個々のデバイスに対応付けられているが、
Measurementウィンドウは測定の条件を設定するウィンドウである。
すなわち、どの軸でスキャンするか、どうやってトリガーシグナルで自動制御するか、といった設定を選択できる。

'Sync first axis'は、ハードウェアで制御される最初の軸の設定である。
コンピューターは、このデバイスからピクセル同期信号(pixel sync)が得られると想定する（得られるかどうかのチェックはできない）。
このデバイスは必ず同期信号を発生させるように設定されなければならない。
.. (and will tell the framework that it does)
   [e.g. when you enable 'Create sync pulses' in the NiDAQ card]

もう一つのデバイスは、最初の軸の1ラインが終わるまで待たなければならない。
今の所これはいつも同じデバイスで行われ、同期信号も同じデバイスで発生される。

その他のデバイスに関しても、各軸の同期タイミングをどう扱うか、同期信号を監視するかを
プログラムに知らせておかなければならない。

NiDAQmxカード1枚だけでの測定
-------------------------

NIカードには適切な'sync out'を選択してsync inを無効にし、dwell timeをDACs設定で設定しておく。
また、DACs設定では'Create Sync pulses'オプションを選択しておく。

その他の設定、たとえば使用するアナログ入力やカウンターチャンネルなどを好きなように設定して良い。

もし、NiDAQカードだけを使うときは少なくとも1つのアナログ入力かCNTR入力は選択しておく。
測定を開始するときに、ダイアログが現れる。

もしNiDAQカードのTTL出力の設定が必要な場合には、AbberiorInstrumentsに問い合わせる。



データの解析
---------------

すべての解析機能はコンテキストメニューから選択できる。
画像、グラフ、軸、カラーマップなどの上で右クリックを押すと、その部分に対応するコンテキストメニューが現れる。
もっともよく使われる機能は、ツールバーボタンとして表示されている。

